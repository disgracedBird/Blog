{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
  {% if categories %}
    {% for category in categories %}
      <div class="mb-12 md:mb-16">

        <!-- Category -->
        <div class="flex items-center gap-4 mb-6">
          <a href="{% url 'app:detail-category' category.pk %}">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800">
              {{ category.category }}
            </h2>
          </a>
        </div>

        <!-- Posts related to certain category -->
        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6">
          {% for post in category.recent_posts %}
            <div class="group relative overflow-hidden rounded-lg shadow-md hover:shadow-xl transition-all duration-300 bg-white">
              <a href="{% url 'app:detail-post' post.pk %}" class="block h-full">
                <div class="aspect-[4/3] overflow-hidden bg-gray-100">
                  {% if post.post_img %}
                    <img 
                      src="{{ post.post_img.url }}" 
                      alt="{{ post.post_alt|default:post.post_name }}" 
                      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                      loading="lazy"
                    >
                  {% else %}
                    <img 
                      src="{% static 'imgs/default.jpg' %}" 
                      alt="Default image" 
                      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                      loading="lazy"
                    >
                  {% endif %}
                </div>

                <div class="p-3 md:p-4">
                  <h3 class="text-sm md:text-base font-semibold text-gray-900 line-clamp-2 group-hover:text-fuchsia-700 transition-colors text-center">
                    {{ post.post_name }}
                  </h3>
                  <p class="mt-1 text-xs text-gray-600 line-clamp-1">
                    {{ post.post_description|truncatewords:15|default:"" }}
                  </p>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  {% else %}
    <div class="text-center py-16 text-gray-600">
      <p class="text-xl">No categories or posts found yet.</p>
      {% if user.is_authenticated %}
        <a href="{% url 'app:create-category' %}" class="mt-4 inline-block text-fuchsia-600 hover:underline">
          Create your first category â†’
        </a>
      {% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}